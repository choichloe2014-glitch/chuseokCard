<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <title>🌕 추석 편지 생성기</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bulma -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
    <!-- 인쇄: 카드만 보이게 (Bulma는 유지) -->
    <style>
        @media print {
            body * {
                visibility: hidden !important;
            }

            #printCard,
            #printCard * {
                visibility: visible !important;
            }

            #printCard {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                margin: 0;
                box-shadow: none;
            }
        }
    </style>
</head>

<body class="has-background-light">
    <section class="section">
        <div class="container">
            <h1 class="title has-text-centered">🌕 추석 편지 생성기</h1>

            <!-- 입력 폼 -->
            <div class="box">
                <div class="field">
                    <label class="label">받는 사람</label>
                    <div class="control">
                        <input id="to" class="input" type="text" placeholder="예) 할머니">
                    </div>
                </div>

                <div class="field">
                    <label class="label">보내는 사람</label>
                    <div class="control">
                        <input id="from" class="input" type="text" placeholder="예) 지영">
                    </div>
                </div>

                <div class="field">
                    <label class="label">편지 톤</label>
                    <div class="control">
                        <div class="select">
                            <select id="tone">
                                <option value="warm">따뜻하게</option>
                                <option value="cheerful">유쾌하게</option>
                                <option value="formal">격식 있게</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="field">
                    <label class="label">소원 (원하는 것만 체크)</label>
                    <div class="control">
                        <label class="checkbox mr-3"><input type="checkbox" class="wish" value="건강"> 건강</label>
                        <label class="checkbox mr-3"><input type="checkbox" class="wish" value="행복"> 행복</label>
                        <label class="checkbox mr-3"><input type="checkbox" class="wish" value="풍요"> 풍요</label>
                        <label class="checkbox mr-3"><input type="checkbox" class="wish" value="안전"> 안전</label>
                        <label class="checkbox"><input type="checkbox" class="wish" value="성장"> 성장</label>
                    </div>
                </div>

                <div class="field">
                    <label class="label">추가로 꼭 전하고 싶은 말 (선택)</label>
                    <div class="control">
                        <textarea id="extra" class="textarea" placeholder="예) 지난번에 보내주신 과일 정말 맛있게 잘 먹었어요!"></textarea>
                    </div>
                </div>

                <div class="buttons">
                    <button id="makeBtn" class="button is-primary">편지 만들기</button>
                    <button id="copyBtn" class="button is-link">복사하기</button>
                    <button id="printBtn" class="button is-warning">인쇄하기(이미지+편지)</button>
                </div>
            </div>

            <!-- 카드 (이미지 아래에 편지) -->
            <div class="card" id="printCard">
                <div class="card-image">
                    <figure class="image is-4by3">
                        <img src="https://www.home-learn.co.kr/common/image.do?imgPath=newsroom&imgName=CK20230816093439541.png&imgGubun=D"
                            alt="추석 배경">
                    </figure>
                </div>
                <div class="card-content">
                    <div class="content">
                        <pre id="letter" style="white-space: pre-wrap;">여기에 편지가 표시됩니다.</pre>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- 수업에서 script를 채워나갑니다.-->
    <script>
        // STEP에서 안내하는 코드로 업데이트해나가기
        const openings = {
                warm: [
                    "보름달처럼 둥글고 따뜻한 추석이에요!",
                    "잘 지내시죠? 오랜만이에요!",
                    "달빛처럼 반가운 마음 전해요!"
                ],
                cheerful: [
                    "송편 맛있게 드시면서 즐거운 추석 보내세요!",
                    "게임처럼 재미있는 추석 되길 바라요!",
                    "웃음소리 가득한 명절 되세요!"
                ],
                formal: [
                    "즐거운 추석 연휴 보내세요!",
                    "맛있는 거 많이 드시고 건강하세요!",
                    "행복한 추석 되세요!"
                ]
            };

        const bodies = {
            warm: [
                "맛있는 음식 많이 드시고 푹 쉬세요!",
                "보고 싶어요, 건강하게 지내세요!",
                "작은 마음이지만 따뜻하게 전해요."
            ],
            cheerful: [
                "맛난 송편은 제 몫도 꼭 남겨주세요!",
                "사진 많이 찍어서 나중에 보여주세요!",
                "즐거움이 듬뿍 담긴 추석이 되길 바라요!"
            ],
            formal: [
                "추석 연휴 동안 가족과 즐거운 시간 보내세요!",
                "항상 건강하시고 좋은 일만 가득하시길 바랍니다.",
                "앞으로도 행복 가득하시길 바래요!"
            ]
        };

        function pick(arr) {
            const idx = Math.floor(Math.random() * arr.length);
            return arr[idx];
        }

        function today(){
            const now = new Date();

            const year = now.getFullYear();  // 2025
            const month = now.getMonth();    //10
            const date = now.getDate();    //1

            return year + '년 ' + month + '월 ' + date +'일 ';
        }

        function buildLetter() {
            const to = document.getElementById('to').value || "가족분들";
            const from = document.getElementById('from').value || "지영";
            const tone = document.getElementById('tone').value; 
            const extra = document.getElementById('extra').value;

           
            const boxes = document.querySelectorAll('.wish:checked');
            let wishes = [];

           
            for (let i = 0; i < boxes.length; i++) {
                wishes.push(boxes[i].value);
            }

          
            const opening = pick(openings[tone]);
            const body = pick(bodies[tone]);

            let wishline = '';
            if (wishes.length > 0 ) {
                wishline = '이번 추석에는 ' +wishes.join(', ') + ' 가득하시길 바라요!';
            } else {
                wishline = '이번 추석에는 행복 가득하시길 바라요!';
            }

            //const wishline = 
                //'이번 추석에는 ' + wishes.join('/') + ' 가득하시길 바라요!';

             const text =
                 to + '께, \n\n' + opening + '\n' + body + '\n' +
               wishline + '\n' + extra + '\n' + '\n' + today() + '\n' + from + ' 올림';
          

            document.getElementById('letter').textContent = text; 
        }

        function copyLetter() {
            const t = document.getElementById("letter").textContent;

            if(!t.trim()){
                alert("먼저 편지를 만들어주세요.")
                return;

            }
            navigator.clipboard.writeText(t).then(
                function(){
                    alert("편지를 클립보드에 복사했어요.")
                }).catch(function(){
                    alert("복사가 지원되지 않아요. 직접 드래그해서 복사하세요!")
                });
        }

        function printLetter() {
            if (!document.getElementById("letter").textContent.trim())
            alert("먼저 편지를 만들어주세요!")
            return;

            window.print();
        }
        
        document.addEventListener("DOMContentLoaded", () => {
            document.getElementById('makeBtn').onclick = buildLetter;
            document.getElementById('copyBtn').onclick = copyLetter;
            document.getElementById('printBtn').onclick = printLetter;
        });
        
    </script>
</body>

</html>